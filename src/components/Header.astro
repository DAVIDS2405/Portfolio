---
import Menu from "@icons/Menu.astro";
---

<header
  class="flex flex-col text-xs py-2 bg-black items-center justify-center top-0 lg:border-2 lg:rounded-full lg:border-white lg:flex-row lg:py-6 lg:top-1 sticky mx-auto w-full md:max-w-3xl z-50"
>
  <button id="menu-bar" class="flex w-full p-4 text-xl justify-end lg:hidden">
    <Menu class="size-9" />
  </button>

  <nav
    class="hidden bg-black absolute w-full h-dvh justify-center items-center gap-y-20 top-14 lg:top-0 lg:py-1 lg:flex lg:h-full lg:rounded-full lg:items-center lg:justify-center lg:flex-row lg:gap-x-10"
    id="menu-open"
  >
    <a href="#inicio" class="hover:text-red-300">Inicio</a>
    <a href="#experiencia" class="transition hover:text-red-300">Experiencia</a>
    <a href="#proyectos" class="hover:text-red-300">Proyectos</a>
    <a href="#sobremi" class="hover:text-red-300">Sobre m√≠</a>
    <a href="mailto:sebastian2405lucero@hotmail.com" class="hover:text-red-300"
      >Contacto</a
    >
  </nav>
</header>

<style>
  .menu-open-css {
    @apply flex flex-col;
  }
  .menu-hidden-css {
    @apply hidden;
  }
  .text-color-new {
    @apply text-red-300;
  }
</style>

<script>
  const button = document.querySelector("#menu-bar") as Element;
  const menuOpen = document.querySelector("#menu-open") as Element;
  const enlaces = document.querySelectorAll("#menu-open a");
  let navenlaces = document.querySelectorAll("header nav a");
  let secciones = document.querySelectorAll("section");
  button.addEventListener("click", () => {
    menuOpen.classList.toggle("menu-open-css");
  });

  menuOpen.addEventListener("click", () => {
    menuOpen.classList.remove("menu-open-css");
  });

  window.onscroll = () => {
    secciones.forEach((seccion) => {
      let top = window.scrollY;
      let offset = seccion.offsetTop - 150;
      let height = seccion.offsetHeight;
      let id = seccion.getAttribute("id");

      if (top >= offset && top < offset + height) {
        navenlaces.forEach((enlace) => {
          enlace.classList.remove("text-color-new");
          document
            .querySelector("header nav a[href*=" + id + "]")
            ?.classList.add("text-color-new");
        });
      }
    });
  };
</script>
